{"version":3,"file":"calculator.js","sourceRoot":"","sources":["../../../src/components/calculator.ts"],"names":[],"mappings":"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","sourcesContent":["import {LitElement, html, css} from 'lit';\nimport {customElement, property} from 'lit/decorators.js';\nimport {TemplateResult} from 'lit-element';\nimport {ifDefined} from 'lit/directives/if-defined.js';\n\nimport {VtbElement} from '../models.js';\n\n@customElement('vtb-calculator-element')\nexport class VtbCalculatorPriceElement extends LitElement {\n  static override styles = css`\n    .price-calculator-element:after {\n      content: '';\n      display: block;\n      clear: both;\n    }\n\n    .price-calculator-element > div {\n      float: left;\n    }\n\n    .description {\n      width: 70%;\n    }\n\n    .price {\n      width: 30%;\n      text-align: right;\n    }\n\n    h3 {\n      display: block;\n    }\n  `;\n\n  @property({type: String})\n  locale = 'nl-NL';\n\n  @property({type: String})\n  currency = 'EUR';\n\n  @property({type: Number})\n  price = 0;\n\n  @property({type: String, attribute: 'price-type'})\n  price_type = 'pp';\n\n  @property({\n    type: String,\n    attribute: 'display-price',\n    converter: (value, _type) => {\n      // console.info('value', value, typeof value);\n      // console.info('type', _type);\n\n      if (typeof value == 'string' && value == 'true') {\n        return true;\n      }\n\n      if (typeof value == 'string' && value == 'false') {\n        return false;\n      }\n\n      if (typeof value == 'boolean') {\n        return value;\n      }\n\n      if (value) {\n        return value.toString();\n      }\n\n      return false;\n    }\n  })\n  display_price: boolean | string = false;\n\n  @property({\n    type: Boolean,\n    attribute: 'display-zero',\n    converter: (value, _type) => {\n      if (typeof value == 'string' && value == 'true') {\n        return true;\n      }\n\n      if (typeof value == 'string' && value == 'false') {\n        return false;\n      }\n\n      if (typeof value == 'boolean') {\n        return value;\n      }\n\n      if (value) {\n        return true;\n      }\n\n      return false;\n    }\n  })\n  display_prices_if_zero = false;\n\n  override render() {\n    // console.info('VtbCalculatorPriceElement:render');\n    const priceRenderer = new Intl.NumberFormat(this.locale, {\n      style: 'currency',\n      currency: this.currency\n    });\n\n    let priceDisplay = '';\n    if (this.display_price && typeof this.display_price == 'boolean') {\n      priceDisplay = priceRenderer.format(this.price) as string;\n    }\n\n    if (!this.display_price && typeof this.display_price == 'boolean') {\n      priceDisplay = '';\n    }\n\n    if (this.display_price && typeof this.display_price == 'string') {\n      priceDisplay = this.display_price;\n    }\n\n    if (\n      this.display_price &&\n      typeof this.display_price == 'boolean' &&\n      this.price == 0 &&\n      !this.display_prices_if_zero\n    ) {\n      priceDisplay = '';\n    }\n\n    return html`\n      <div class=\"price-calculator-element\">\n        <div class=\"description\">\n          <slot></slot>\n        </div>\n        <div class=\"price\">${priceDisplay} &nbsp;</div>\n      </div>\n    `;\n  }\n}\n\n@customElement('vtb-calculator-list')\nexport class VtbCalculatorPriceListElement extends LitElement {\n  static override styles = css`\n    :host {\n      display: block;\n    }\n  `;\n\n  @property({type: Boolean, attribute: 'calculate-totals'})\n  calculate_totals = false;\n\n  @property({type: Boolean, attribute: 'display-totals'})\n  display_totals = false;\n\n  @property({type: Boolean, attribute: 'display-prices'})\n  display_prices = false;\n\n  @property({type: Boolean, attribute: 'display-zero'})\n  display_prices_if_zero = false;\n\n  @property({type: String})\n  locale = 'nl-NL';\n\n  @property({type: String})\n  currency = 'EUR';\n\n  @property({type: Number, attribute: 'total-price'})\n  total_price = 0;\n\n  override render() {\n    return html`\n      <div class=\"price-calculator-element-list\">\n        <h3>${this.title}</h3>\n        <div class=\"\">\n          <slot></slot>\n        </div>\n      </div>\n    `;\n  }\n}\n\n@customElement('vtb-calculator')\nexport class VtbCalculatorElement extends LitElement {\n  static override styles = css`\n    :host {\n      display: block;\n    }\n\n    .price-calculator-totals {\n      font-weight: bold;\n      font-size: 110%;\n      border-top: 1px solid #444;\n      margin-top: 1rem;\n      padding-top: 1rem;\n    }\n  `;\n\n  @property({type: Boolean, attribute: 'calculate-totals'})\n  calculate_totals = false;\n\n  @property({type: Boolean, attribute: 'display-totals'})\n  display_totals = false;\n\n  @property({type: Boolean, attribute: 'display-prices'})\n  display_element_prices = false;\n\n  @property({type: String})\n  locale = 'nl-NL';\n\n  @property({type: String})\n  currency = 'EUR';\n\n  @property({type: Number, attribute: 'total-price'})\n  total_price = 0;\n\n  @property({type: String, attribute: false})\n  custom_styles = '';\n\n  // @property({type: Object, attribute: false})\n  // elements?: VtbCalculatorData;\n\n  @property({type: Array, attribute: false})\n  elements: Array<VtbElement> = [];\n\n  @property({type: Array, attribute: false})\n  groups = ['elements', 'surcharges', 'optionals'];\n\n  @property({type: Boolean, attribute: false})\n  show_per_participant = false;\n\n  override render() {\n    let slot_html: string | TemplateResult = '';\n\n    if (this.children.length == 0 && this.elements) {\n      slot_html = this._render_elements();\n    }\n\n    let custom_styles;\n    if (this.custom_styles) {\n      custom_styles = html`\n                <style type=text/css>${this.custom_styles}</style>\n            `;\n    }\n\n    return html`\n      ${custom_styles}\n      <div class=\"price-calculator\">\n        <slot>${slot_html}</slot>\n        ${this.render_totals()}\n      </div>\n    `;\n  }\n\n  private render_totals() {\n    if (this.display_totals && this.total_price > 0) {\n      return html`\n        <div class=\"price-calculator-totals\">\n          <vtb-calculator-element\n            price=${this.total_price}\n            currency=${this.currency}\n            locale=${this.locale}\n            display-price=\"true\"\n          >\n            Totaal\n          </vtb-calculator-element>\n        </div>\n      `;\n    }\n    return '';\n  }\n\n  public render_element_description(element: VtbElement) {\n    return `${element.days} dgn. - ${element.title}`;\n  }\n\n  public get_element_price(element: VtbElement) {\n    return `${element.price}`;\n  }\n\n  private _render_elements() {\n    const elements = this.elements as Array<VtbElement>;\n\n    if (elements.length >= 1) {\n      return html`\n        <vtb-calculator-list title=${ifDefined(this.title)}>\n          ${this._render_price_list(elements)}\n        </vtb-calculator-list>\n      `;\n    }\n\n    return html`<!-- no elements -->`;\n  }\n\n  private _render_price_list(price_list: Array<VtbElement>) {\n    const elementTemplates: Array<TemplateResult> = [];\n\n    for (const element of price_list) {\n      if (element && element.hidden) {\n        continue;\n      }\n\n      elementTemplates.push(html`\n        <vtb-calculator-element\n          price=${parseFloat(this.get_element_price(element))}\n          currency=${this.currency}\n          locale=${this.locale}\n          display-price=${this.display_element_prices}\n        >\n          ${this.render_element_description(element)}\n        </vtb-calculator-element>\n      `);\n    }\n\n    return elementTemplates;\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    'vtb-calculator': VtbCalculatorElement;\n    'vtb-calculator-list': VtbCalculatorPriceListElement;\n    'vtb-calculator-element': VtbCalculatorPriceElement;\n  }\n}\n"]}